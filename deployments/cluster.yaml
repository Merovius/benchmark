resources:
- type: compute.v1.disk
  name: robustirc-disk-1
  properties:
    zone: europe-west1-d
    sizeGb: 100
    type: https://www.googleapis.com/compute/v1/projects/robustirc-loadtest/zones/europe-west1-d/diskTypes/pd-ssd

- type: compute.v1.disk
  name: robustirc-disk-2
  properties:
    zone: europe-west1-d
    sizeGb: 100
    type: https://www.googleapis.com/compute/v1/projects/robustirc-loadtest/zones/europe-west1-d/diskTypes/pd-ssd

- type: compute.v1.disk
  name: robustirc-disk-3
  properties:
    zone: europe-west1-d
    sizeGb: 100
    type: https://www.googleapis.com/compute/v1/projects/robustirc-loadtest/zones/europe-west1-d/diskTypes/pd-ssd

- type: container.v1.cluster
  name: loadtest
  properties:
    zone: europe-west1-d
    cluster:
      initialNodeCount: 3
      nodeConfig:
        machineType: n1-standard-8
        oauth_scopes: 
          - "https://www.googleapis.com/auth/compute"
          - "https://www.googleapis.com/auth/devstorage.read_only"
          # TODO: do we also need logging.write and monitoring?
      masterAuth:
        username: admin
        password: pSnifTOjoFbMg0pXxaLUDwz

- name: loadtest-type
  type: deploymentmanager.alpha.type
  properties:
    configurableService:
      options:
        validationOptions:
          # https://github.com/kubernetes/kubernetes/issues/2971
          schemaValidation: IGNORE_WITH_WARNINGS
      descriptorUrl: https://$(ref.loadtest.endpoint)/swaggerapi/api/v1
      credential:
        basicAuth:
          user: $(ref.loadtest.masterAuth.username)
          password: $(ref.loadtest.masterAuth.password)

outputs:
- name: clusterType
  value: loadtest-type
